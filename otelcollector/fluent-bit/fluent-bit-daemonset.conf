[SERVICE]
    Flush         15
    HTTP_Server   Off
    Daemon        Off
    storage.path  /var/opt/microsoft/state/flbstore/
    storage.sync  normal
    storage.checksum off
    storage.backlog.mem_limit 10M
    Log_Level     debug
    Parsers_File  /opt/fluent-bit/fluent-bit-parsers.conf
    Log_File      /opt/fluent-bit/fluent-bit.log

[INPUT]
    Name          proc
    Proc_Name     otelcollector
    Tag           otelcollector.memVmrss.scrape.wotail

# [FILTER]
#     Name   parser
#     Key_Name  otelcollector.memVmrss.scrape
#     Match otelcollector.memVmrss.scrape
#     Parser memVmrss-parser

[OUTPUT]
    Name file
    Match otelcollector.memVmrss.scrape.wotail
    Path /opt/fluent-bit
    File otelmemfile.log


[INPUT]
    Name tail
    Path /opt/fluent-bit/otelmemfile.log
    Read_from_Head true
    Tag otelcollector.memVmrss.scrape
    Parser memVmrss-parser
    Path_Key filepath


[OUTPUT]
    Name                            appinsights
    Match                           otelcollector.memVmrss.scrape
