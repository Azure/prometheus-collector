apiVersion: tests.testkube.io/v3
kind: Test
metadata:
  name: alltargetsdisabled
  namespace: testkube
  labels:
    executor: ginkgo-executor
    test-type: ginkgo-test
spec:
  type: ginkgo/test
  content:
    type: git
    repository:
      type: git
      uri: https://github.com/Azure/prometheus-collector
      branch: main
      path: otelcollector/test/ginkgo-e2e
  executionRequest:
    variables:
      AMW_QUERY_ENDPOINT:
        name: AMW_QUERY_ENDPOINT
        value: "$AMW_QUERY_ENDPOINT"
        type: basic
      AZURE_CLIENT_ID:
        name: AZURE_CLIENT_ID
        value: "$AZURE_CLIENT_ID"
        type: basic
    args:
      # - "--label-filter"
      # - "!(arc-extension,linux-daemonset-custom-config)"
      - "./configprocessing"
    executePostRunScriptBeforeScraping: false
---
apiVersion: tests.testkube.io/v3
kind: TestSuite
metadata:
  name: e2e-config-tests-nightly
  namespace: testkube
spec:
  steps:
  - stopOnFailure: false
    execute:
    - test: alltargetsdisabled
  # - stopOnFailure: false
  #   execute:
  #   - delay: 2m0s
  # - stopOnFailure: false
  #   execute:
  #   - test: querymetrics