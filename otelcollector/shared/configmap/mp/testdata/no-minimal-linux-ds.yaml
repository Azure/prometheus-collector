scrape_configs:
- job_name: networkobservability-retina
  kubernetes_sd_configs:
  - role: service
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  relabel_configs:
  - action: keep
    regex: kube-system;network-observability;retina
    source_labels:
    - __meta_kubernetes_namespace
    - __meta_kubernetes_service_name
    - __meta_kubernetes_service_port_name
  - action: replace
    replacement: 192.168.1.1
    source_labels:
    - __address__
    target_label: __address__
  - action: replace
    regex: ([^:]+)(?::\d+)?;(\d+)
    replacement: $1:$2
    source_labels:
    - __address__
    - __meta_kubernetes_service_port_number
    target_label: __address__
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  scheme: http
  scrape_interval: 30s
- job_name: networkobservability-cilium
  kubernetes_sd_configs:
  - role: service
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  relabel_configs:
  - action: keep
    regex: kube-system;network-observability;cilium
    source_labels:
    - __meta_kubernetes_namespace
    - __meta_kubernetes_service_name
    - __meta_kubernetes_service_port_name
  - action: replace
    replacement: 192.168.1.1
    source_labels:
    - __address__
    target_label: __address__
  - action: replace
    regex: ([^:]+)(?::\d+)?;(\d+)
    replacement: $1:$2
    source_labels:
    - __address__
    - __meta_kubernetes_service_port_number
    target_label: __address__
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  scheme: http
  scrape_interval: 30s
- bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
  job_name: kubelet
  label_limit: 63
  label_name_length_limit: 511
  label_value_length_limit: 1023
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  metrics_path: /metrics
  relabel_configs:
  - regex: (.*)
    source_labels:
    - __metrics_path__
    target_label: metrics_path
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  - replacement: linux
    source_labels:
    - __address__
    target_label: kubernetes_io_os
  scheme: https
  scrape_interval: 30s
  static_configs:
  - targets:
    - 192.168.1.1:10250
  tls_config:
    ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    insecure_skip_verify: true
- job_name: node
  label_limit: 63
  label_name_length_limit: 511
  label_value_length_limit: 1023
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  relabel_configs:
  - regex: (.*)
    source_labels:
    - __metrics_path__
    target_label: metrics_path
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  scheme: http
  scrape_interval: 30s
  static_configs:
  - targets:
    - 192.168.1.1:9100
- job_name: networkobservability-hubble
  kubernetes_sd_configs:
  - role: service
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  relabel_configs:
  - action: keep
    regex: kube-system;network-observability;hubble
    source_labels:
    - __meta_kubernetes_namespace
    - __meta_kubernetes_service_name
    - __meta_kubernetes_service_port_name
  - action: replace
    replacement: 192.168.1.1
    source_labels:
    - __address__
    target_label: __address__
  - action: replace
    regex: ([^:]+)(?::\d+)?;(\d+)
    replacement: $1:$2
    source_labels:
    - __address__
    - __meta_kubernetes_service_port_number
    target_label: __address__
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  scheme: http
  scrape_interval: 30s
- bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
  job_name: cadvisor
  label_limit: 63
  label_name_length_limit: 511
  label_value_length_limit: 1023
  metric_relabel_configs:
  - action: keep
    regex: test.*|test2
    source_labels:
    - __name__
  metrics_path: /metrics/cadvisor
  relabel_configs:
  - replacement: test-node
    source_labels:
    - __address__
    target_label: instance
  scheme: https
  scrape_interval: 30s
  static_configs:
  - targets:
    - 192.168.1.1:10250
  tls_config:
    ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    insecure_skip_verify: true
