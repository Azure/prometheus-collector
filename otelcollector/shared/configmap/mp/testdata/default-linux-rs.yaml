scrape_configs:
- honor_labels: true
  job_name: acstor-metrics-exporter
  kubernetes_sd_configs:
  - namespaces:
      names:
      - acstor
    role: pod
  metric_relabel_configs:
  - action: keep
    regex: '|disk_pool_ready_state|disk_read_operations_completed_total|disk_write_operations_completed_total|disk_read_operations_time_seconds_total|disk_write_operations_time_seconds_total|disk_errors_total|disk_read_bytes_total|disk_written_bytes_total|disk_readonly_errors_gauge'
    source_labels:
    - __name__
  relabel_configs:
  - action: keep
    regex: acstor
    source_labels:
    - __meta_kubernetes_namespace
  - action: keep
    regex: metrics-exporter;monitor
    source_labels:
    - __meta_kubernetes_pod_label_app_kubernetes_io_name
    - __meta_kubernetes_pod_label_app_kubernetes_io_component
  - action: keep
    regex: metrics
    source_labels:
    - __meta_kubernetes_pod_container_port_name
  scheme: http
  scrape_interval: 30s
- job_name: kube-state-metrics
  label_limit: 63
  label_name_length_limit: 511
  label_value_length_limit: 1023
  metric_relabel_configs:
  - action: keep
    regex: '|kube_job_status_succeeded|kube_job_spec_completions|kube_daemonset_status_desired_number_scheduled|kube_daemonset_status_current_number_scheduled|kube_daemonset_status_number_misscheduled|kube_daemonset_status_number_ready|kube_deployment_status_replicas_ready|kube_pod_container_status_last_terminated_reason|kube_pod_container_status_waiting_reason|kube_pod_container_status_restarts_total|kube_node_status_allocatable|kube_pod_owner|kube_pod_container_resource_requests|kube_pod_status_phase|kube_pod_container_resource_limits|kube_replicaset_owner|kube_resourcequota|kube_namespace_status_phase|kube_node_status_capacity|kube_node_info|kube_pod_info|kube_deployment_spec_replicas|kube_deployment_status_replicas_available|kube_deployment_status_replicas_updated|kube_statefulset_status_replicas_ready|kube_statefulset_status_replicas|kube_statefulset_status_replicas_updated|kube_job_status_start_time|kube_job_status_active|kube_job_failed|kube_horizontalpodautoscaler_status_desired_replicas|kube_horizontalpodautoscaler_status_current_replicas|kube_horizontalpodautoscaler_spec_min_replicas|kube_horizontalpodautoscaler_spec_max_replicas|kubernetes_build_info|kube_node_status_condition|kube_node_spec_taint|kube_pod_container_info|kube_.*_labels|kube_.*_annotations|kube_service_info|kube_pod_container_status_running|kube_pod_container_status_waiting|kube_pod_container_status_terminated|kube_pod_container_state_started|kube_pod_created|kube_pod_start_time|kube_pod_init_container_info|kube_pod_init_container_status_terminated|kube_pod_init_container_status_terminated_reason|kube_pod_init_container_status_ready|kube_pod_init_container_resource_limits|kube_pod_init_container_status_running|kube_pod_init_container_status_waiting|kube_pod_init_container_status_restarts_total|kube_pod_container_status_ready|kube_pod_init_container_*|kube_pod_deletion_timestamp|kube_pod_status_reason|kube_pod_init_container_resource_requests'
    source_labels:
    - __name__
  scrape_interval: 30s
  static_configs:
  - targets:
    - ama-metrics-ksm.kube-system.svc.cluster.local:8080
- honor_labels: true
  job_name: acstor-capacity-provisioner
  kubernetes_sd_configs:
  - namespaces:
      names:
      - acstor
    role: pod
  metric_relabel_configs:
  - action: keep
    regex: '|storage_pool_ready_state|storage_pool_capacity_used_bytes|storage_pool_capacity_provisioned_bytes|storage_pool_snapshot_capacity_reserved_bytes'
    source_labels:
    - __name__
  relabel_configs:
  - action: keep
    regex: acstor
    source_labels:
    - __meta_kubernetes_namespace
  - action: keep
    regex: capacity-provisioner;capacity-provisoner
    source_labels:
    - __meta_kubernetes_pod_label_app_kubernetes_io_name
    - __meta_kubernetes_pod_label_app_kubernetes_io_component
  - action: keep
    regex: metrics
    source_labels:
    - __meta_kubernetes_pod_container_port_name
  scheme: http
  scrape_interval: 30s
